<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>야구 구단 유튜브 영상</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    /* ===== 크기/간격을 한 곳에서 조절 ===== */
    :root{
      --wrap: 1120px;   /* 전체 영역 폭 (5열이 딱 맞게) */
      --gap: 16px;      /* 카드 간격 */
      --radius: 12px;   /* 카드 둥근모서리 */
      --title: 13px;    /* 제목 폰트 크기 */
      --pad-x: 16px;    /* 좌우 패딩 */
    }

    body{ font-family:'Malgun Gothic', Arial, sans-serif; margin:0; background:transparent; overflow-x:hidden; overflow-y:auto; }
    *{ scrollbar-width:none; -ms-overflow-style:none; }
    *::-webkit-scrollbar{ display:none; }

    .wrap{ max-width:var(--wrap); margin:20px auto 40px; padding:0 var(--pad-x); }
    h1{ color:#2c3e50; font-size:1.9rem; margin:10px 0 14px; font-weight:800; letter-spacing:-0.5px; text-align:center; }

    /* 팀 선택 바 */
    .teams-bar{ display:flex; flex-wrap:wrap; gap:10px; justify-content:center; margin:8px 0 24px; }
    .team-btn{
      appearance:none; border:1px solid #d7dbe8; background:#f4f7fb; color:#1a73e8;
      padding:8px 12px; border-radius:12px; font-weight:700; cursor:pointer; text-decoration:none;
    }
    .team-btn:hover{ background:#e8f0fe; }
    .team-btn.active{ background:#1a73e8; color:#fff; border-color:#1a73e8; }

    .section{ margin-top:26px; }
    .section-head{ display:flex; align-items:center; gap:8px; margin:10px 0 12px; }
    .section-head h2{ font-size:1.3rem; font-weight:800; color:#1a73e8; margin:0; }
    .arrows{ display:flex; gap:6px; }
    .arrow-btn{ background:none; border:none; font-size:24px; color:#1a73e8; cursor:pointer; padding:2px 6px; border-radius:6px; }
    .arrow-btn:hover{ background:#e8f0fe; }

    /* ▶ 데스크톱: 정확히 5열 고정 */
    .grid{
      display:grid;
      grid-template-columns: repeat(5, 1fr);
      gap: var(--gap);
    }


    .card{
      background:#fff; border-radius:var(--radius);
      box-shadow:0 2px 8px #0002; border:1px solid #f0f1f6; overflow:hidden;
      transition:.2s box-shadow,.2s transform,.2s border-color; text-decoration:none; color:inherit; display:block;
    }
    .card:hover{ box-shadow:0 8px 24px #0003; transform:translateY(-4px) scale(1.02); border-color:#1a73e8; }
    .thumb{ width:100%; aspect-ratio:16/9; object-fit:cover; display:block; }

    .title{
      font-size:var(--title); font-weight:600; color:#222; text-align:left;
      padding:8px 10px 10px; line-height:1.35;
      white-space:normal; overflow:visible; display:block; text-decoration:none;
    }

    .center{ text-align:center; color:#8a8fa0; padding:18px 0; }
    .hidden{ display:none; }
  </style>
</head>
<body>
<div class="wrap">
  <h1>{{ team_name }}</h1>

  <!-- 팀 선택 -->
  <div class="teams-bar">
    {% for short, full in teams.items() %}
      <a class="team-btn {{ 'active' if (team_name == full or team_name == short) else '' }}"
         href="/club?team={{ short }}">{{ short }}</a>
    {% endfor %}
  </div>

  <!-- 롱폼 -->
  <section class="section">
    <div class="section-head">
      <h2>🎬 롱폼</h2>
      <div class="arrows">
        <button id="long-prev" class="arrow-btn hidden" aria-label="이전">‹</button>
        <button id="long-next" class="arrow-btn hidden" aria-label="다음">›</button>
      </div>
    </div>
    <div id="long-grid" class="grid"></div>
  </section>

  <!-- 숏폼 -->
  <section class="section">
    <div class="section-head">
      <h2>📱 숏폼 (Shorts)</h2>
      <div class="arrows">
        <button id="short-prev" class="arrow-btn hidden" aria-label="이전">‹</button>
        <button id="short-next" class="arrow-btn hidden" aria-label="다음">›</button>
      </div>
    </div>
    <div id="short-grid" class="grid"></div>
  </section>

  <div id="empty" class="center hidden">관련 영상을 찾을 수 없습니다.</div>
</div>

<script>
  const PAGE = 5;       // 한 페이지 5개
  let S=[], L=[], sp=0, lp=0;

  async function loadData() {
    const q = new URLSearchParams(location.search);
    const team = q.get('team') || 'LG';
    const body = { club: team };

    const res  = await fetch('/search', {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify(body)
    });
    const data = await res.json();
    S = data.short || [];
    L = data.long  || [];
    sp = lp = 0;

    renderSection('short', S, sp);
    renderSection('long',  L, lp);
    document.getElementById('empty').classList.toggle('hidden', (S.length+L.length) > 0);
  }

  function cardHTML(v){
    const t = (v.title||'').replaceAll('"','&quot;');
    const img = v.thumbnail ? `<img class="thumb" src="${v.thumbnail}" alt="${t}">` : '';
    return `<a class="card" href="${v.url}" target="_blank" rel="noopener">${img}<div class="title">${t}</div></a>`;
  }

  function renderSection(kind, list, page){
    const grid = document.getElementById(kind==='short' ? 'short-grid' : 'long-grid');
    const prev = document.getElementById(kind==='short' ? 'short-prev' : 'long-prev');
    const next = document.getElementById(kind==='short' ? 'short-next' : 'long-next');

    const start = page*PAGE, end = start+PAGE;
    grid.innerHTML = list.slice(start,end).map(cardHTML).join('');

    prev.classList.toggle('hidden', page<=0);
    next.classList.toggle('hidden', end>=list.length);

    prev.onclick = () => {
      if(page>0){
        if(kind==='short'){ sp--; renderSection('short', S, sp); }
        else              { lp--; renderSection('long',  L, lp); }
      }
    };
    next.onclick = () => {
      if(end<list.length){
        if(kind==='short'){ sp++; renderSection('short', S, sp); }
        else              { lp++; renderSection('long',  L, lp); }
      }
    };
  }

  loadData();
</script>
</body>
</html>
